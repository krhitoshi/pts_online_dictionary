<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>The Pāḷi Text Society's Pāli-English Dictionary</title>
  <style>
      body {
          font-size: 1.2em;
      }
      table {
          border-collapse: collapse;
      }
      table, th, td {
          border: 1px solid black;
      }

      /* light gray line */
      hr {
          border: 0;
          height: 1px;
          background: #ccc;
      }
  </style>
  <script>
    // load ptsd.json
    const loadJSON = (callback) => {
      let ptsd = null;
      const xhr = new XMLHttpRequest();
      xhr.open('GET', 'ptsd.json', true);
      // call callback to treat with the JSON data
      xhr.onload = () => {
        if (xhr.status === 200) {
          ptsd = xhr.responseText;
          callback(ptsd);
        } else {
          console.log(`Request failed. Returned status of ${xhr.status}`);
        }
      };

      xhr.send(null);
    };

    // execute loadJSON when page loads
    window.onload = () => {
      loadJSON((response) => {
        // Parse JSON string into object
        const data = JSON.parse(response);
        console.log(data.length);
        displayNumDefinitions(data);
        displayDefinitions(data);
      });
    };

    // display the number of definitions
    const displayNumDefinitions = (data) => {
      const numDefinitions = document.getElementById('num-definitions');
      numDefinitions.innerHTML = `Definitions: ${data.length}`;
    };

    // display the definitions
    const displayDefinitions = (data) => {
      const table = document.getElementById('definitions');
      data.forEach((item, index) => {
        const row = table.insertRow(index + 1);
        const headword = row.insertCell(0);
        headword.innerHTML = item.headword;
        const definition = row.insertCell(1);
        definition.innerHTML = item.definition;
        // add memo into definition if memo is not empty
        if (item.memo !== '') {
          definition.innerHTML += `<hr>${item.memo}`;
        }
      });
    };
  </script>
</head>
<body>
<h1>The Pāḷi Text Society's Pāli-English Dictionary</h1>
<p id="num-definitions"></p>
<table id="definitions">
  <tr>
    <th>Headword</th>
    <th>Definition</th>
  </tr>
</table>
</body>
</html>